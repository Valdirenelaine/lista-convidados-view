<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lista Convidados Vue</title>
    <link type="text/css" rel="stylesheet" href="https://unpkg.com/bootstrap/dist/css/bootstrap.min.css" />
    <link type="text/css" rel="stylesheet" href="https://unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.min.css" />
</head>

<body>
    <div id="app">
        <b-container>
            <form>
                <h1>{{titulo}}</h1>
                <b-form-group label="Nome" label-for="nome">
                    <b-form-input id="nome" v-model="convidado.nome" type="text" placeholder="Ex: Jão da Silva" required></b-form-input>
                </b-form-group>
                <b-form-group label="Idade" label-for="idade">
                    <b-form-input id="idade" v-model="convidado.idade" type="number" placeholder="Ex: 20" required>
                    </b-form-input>
                </b-form-group>
                <b-form-group label="Email" label-for="email">
                    <b-form-input id="email" v-model="convidado.email" type="email" placeholder="Ex: jao@gmail.com" required></b-form-input>
                </b-form-group>
                <b-form-group label="CEP" label-for="cep">
                    <b-form-input v-mask="'##.###-###'" id="cep" v-model="convidado.endereco.cep" type="text" placeholder="Ex. 79.041-080" required></b-form-input>
                </b-form-group>
                <b-button variant="outline-warning">Limpar lista</b-button>
                <b-button variant="outline-danger">Cancelar</b-button>
                <b-button type="submit" variant="success" @click="salvar">Salvar</b-button>
            </form>
            <b-table striped :items="listaConvidados" :fields="campos">
                <template v-slot:cell(acoes)="row">
                    <b-button><img src="img/pencil.svg" @click="editar(row.index)" width="20" alt="icone do editar"></b-button>
                    <b-button><img src="img/trash.svg" @click="confirmarRemocao(row.index)" width="20" alt="icone de excluir"></b-button>
                </template>
            </b-table>

        </b-container>
        <b-modal title="Alerta de Exlusão" centered v-model="exibirModalRemocao">
            <p>Deseja Realmente Excluir?</p>
            <template v-slot:modal-footer="{ cancel }">
                <b-button @click="remover" variant="outline-danger">Sim</b-button>
                <b-button @click="cancel" variant="primary">Cancelar</b-button>
            </template>
        </b-modal>
    </div>

    <script src="https://polyfill.io/v3/polyfill.min.js?features=es2015%2CIntersectionObserver " crossorigin="anonymous "></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js "></script>
    <script src="https://unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.min.js "></script>
    <script src="https://unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue-icons.min.js "></script>
    <script src="https://cdn.jsdelivr.net/npm/v-mask/dist/v-mask.min.js "></script>
    <script>
        Vue.use(VueMask.VueMaskPlugin)
            //instanciando um novo Vue
        let app = new Vue({
            el: "#app ",
            data: {
                titulo: "Lista de Convidados ",
                indiceEdicao: -1,
                indiceRemocao: -1,
                exibirModalRemocao: false,
                listaConvidados: [],
                convidado: {
                    endereco: {}
                },
                campos: [{
                        label: "Nome",
                        key: "nome",
                        sortable: true
                    }, {
                        label: "Idade",
                        key: "idade",
                        sortable: false
                    }, {
                        label: "Email",
                        key: "email",
                        sortable: true
                    }, {
                        label: "CEP",
                        key: "endereco.cep",
                        sortable: false
                    }, {
                        label: "Ações",
                        key: "acoes",
                        sortable: false
                    }

                ]

            },
            methods: {
                salvar() {
                    this.indiceEdicao > -1 ?
                        this.listaConvidados.splice(this.indiceEdicao, 1, this.convidado) :
                        this.listaConvidados.push(this.convidado)
                    this.limpar()
                },
                limpar() {
                    this.convidado = {
                        endereco: {}
                    }
                    this.indiceEdicao = -1
                    this.indiceRemocao = -1
                },
                editar(index) {
                    this.convidado = JSON.parse(JSON.stringify(this.listaConvidados[index]))
                    this.indiceEdicao = index


                },
                remover() {
                    this.listaConvidados.splice(this.indiceRemocao, 1)
                    this.exibirModalRemocao = false
                    this.limpar()

                },
                confirmarRemocao(index) {
                    this.exibirModalRemocao = true
                    this.indiceRemocao = index
                }
            }
        })
    </script>
</body>

</html>